<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PHONK SYSTEM PRO</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        /* FIX T·ªîNG TH·ªÇ CHO C·∫¢ TV V√Ä ƒêI·ªÜN THO·∫†I */
        html, body {
            overflow-y: auto !important;
            height: auto !important;
            min-height: 100vh;
            background-color: #000;
            margin: 0;
            padding: 0;
            -ms-overflow-style: scrollbar !important;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 15px;
            display: flex;
            flex-direction: column;
            min-height: 100vh; 
        }

        .playlist-container {
            flex: 1; 
            height: auto !important;
            max-height: none !important;
            overflow: visible !important;
            margin-bottom: 20px;
        }

        .controls {
            padding: 15px 0;
            background: rgba(0,0,0,0.8);
            border-top: 1px solid #333;
        }

        #status {
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
            padding-bottom: 30px; 
        }

        .song-item:focus, .song-item.active {
            background: rgba(255, 0, 0, 0.2) !important;
            border-left: 5px solid red !important;
        }

        /* --- STYLE M·ªöI CHO B·ªò T·∫¢I NH·∫†C --- */
        .btn-upload-top {
            position: fixed;
            top: 10px;
            left: 10px;
            z-index: 9999;
            padding: 8px 12px;
            background: #24292e;
            color: #ff0000;
            border: 1px solid #ff0000;
            border-radius: 5px;
            font-size: 11px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-yt-opener {
            width: 100%;
            padding: 15px;
            background: linear-gradient(45deg, #ff0000, #990000);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            margin-bottom: 15px;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(255,0,0,0.4);
        }

        #yt-menu {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 85%;
            max-width: 350px;
            background: #111;
            padding: 20px;
            border: 2px solid red;
            border-radius: 15px;
            z-index: 10000;
            text-align: center;
            box-shadow: 0 0 30px rgba(255,0,0,0.6);
        }

        #yt-url {
            width: 100%;
            padding: 12px;
            margin: 15px 0;
            background: #222;
            border: 1px solid #444;
            color: white;
            border-radius: 5px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>
    <button class="btn-upload-top" onclick="window.open('https://github.com/phucnguyen987/Phonk-web/upload/main/music', '_blank')">üìÇ UPLOAD TO GITHUB</button>

    <div id="intro-page">
        <div class="intro-content">
            <h1 class="glitch">‚ò£Ô∏è PHUCNGUYEN X PHONK ‚ò£Ô∏è</h1>
            <p>H∆†N 50 B√ÄI HAY NH·∫§T 2026 | HO·∫†T ƒê·ªòNG 24/7</p>
            <button class="start-btn" onclick="startAppFixed()">V√ÄO H·ªÜ TH·ªêNG</button>
        </div>
    </div>

    <div class="container">
        <h2 class="neon-text">üéµPHONK MUSICüéµ</h2>
        
        <button class="btn-yt-opener" onclick="document.getElementById('yt-menu').style.display='block'">üì• T·∫¢I NH·∫†C T·ª™ YOUTUBE (.MP3)</button>

        <input type="text" id="searchInput" placeholder="T√¨m t√™n b√†i Phonk..." onkeyup="filterSongs()">

        <div id="customPlaylist" class="playlist-container">
            </div>

        <div class="controls">
            <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                <button class="btn-main" style="flex: 2;" onclick="handlePlay()" id="playBtn">PH√ÅT NH·∫†C</button>
                <button class="btn-loop" style="flex: 1;" onclick="handleLoop()" id="loopBtn">L·∫∂P: T·∫ÆT</button>
            </div>
            <div id="status">‚úÖ ƒê√£ s·∫µn s√†ng: 7 b√†i!</div>
        </div>
    </div>

    <div id="yt-menu">
        <h3 style="margin-top:0; color:red;">DOWNLOAD MP3</h3>
        <p style="font-size:11px; color:gray;">D√°n link video v√† ƒë·ª£i h·ªá th·ªëng t·∫£i v·ªÅ m√°y</p>
        <input type="text" id="yt-url" placeholder="https://www.youtube.com/watch?v=...">
        <button id="dl-btn" onclick="startDirectDownload()" style="width:100%; padding:12px; background:#fff; color:#000; border:none; border-radius:5px; font-weight:bold; cursor:pointer;">
            B·∫ÆT ƒê·∫¶U T·∫¢I V·ªÄ
        </button>
        <div id="dl-loading" style="display:none; margin-top:10px; color:yellow; font-size:12px;">ƒêang x·ª≠ l√Ω... Vui l√≤ng kh√¥ng ƒë√≥ng!</div>
        <button onclick="document.getElementById('yt-menu').style.display='none'" style="margin-top:15px; background:none; border:none; color:gray; cursor:pointer;">ƒê√≥ng</button>
    </div>

    <audio id="mainAudio" playsinline></audio>
    <script src="script.js"></script>

    <script>
        function startAppFixed() {
            document.getElementById('intro-page').style.display = 'none';
            if (typeof startApp === "function") startApp();
            setTimeout(() => { window.scrollTo(0, 0); }, 300);
        }

        // ƒêI·ªÄU KHI·ªÇN REMOTE TV
        window.addEventListener("keydown", function(e) {
            const step = 200; 
            if (e.keyCode === 40) { window.scrollBy({ top: step, behavior: 'smooth' }); }
            else if (e.keyCode === 38) { window.scrollBy({ top: -step, behavior: 'smooth' }); }
        });

        // H√ÄM T·∫¢I NH·∫†C TR·ª∞C TI·∫æP (KH√îNG QUA Y2MATE)
        function startDirectDownload() {
            const url = document.getElementById('yt-url').value;
            const btn = document.getElementById('dl-btn');
            const loading = document.getElementById('dl-loading');

            if (!url.includes("youtube.com") && !url.includes("youtu.be")) {
                alert("Vui l√≤ng d√°n ƒë√∫ng link YouTube!");
                return;
            }

            btn.style.display = 'none';
            loading.style.display = 'block';

            // Tr√≠ch xu·∫•t ID video
            let videoId = "";
            if(url.includes("v=")) { videoId = url.split("v=")[1].split("&")[0]; }
            else { videoId = url.split("/").pop(); }

            // G·ªçi API t·∫£i nh·∫°c tr·ª±c ti·∫øp (T·ª± ƒë·ªông t·∫£i v·ªÅ m√°y)
            const apiUrl = `https://api.vevioz.com/api/button/mp3/${videoId}`;
            
            // T·∫°o Iframe ·∫©n ƒë·ªÉ k√≠ch ho·∫°t l·ªánh t·∫£i c·ªßa tr√¨nh duy·ªát
            const dlFrame = document.createElement('iframe');
            dlFrame.style.display = 'none';
            dlFrame.src = apiUrl;
            document.body.appendChild(dlFrame);

            setTimeout(() => {
                loading.innerHTML = "‚úÖ ƒêang t·∫£i... Ki·ªÉm tra th√¥ng b√°o m√°y!";
                setTimeout(() => {
                    loading.style.display = 'none';
                    btn.style.display = 'block';
                    document.getElementById('yt-menu').style.display = 'none';
                }, 3000);
            }, 2000);
        }
    </script>
</body>
                                                                                                          </html>
    
